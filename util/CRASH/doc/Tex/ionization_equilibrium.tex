%  Copyright (C) 2002 Regents of the University of Michigan, portions used with permission 
%  For more information, see http://csem.engin.umich.edu/tools/swmf
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english,10pt]{revtex4}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{nicefrac}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.



\usepackage{nicefrac}


\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.



\usepackage{nicefrac}



\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.



\usepackage{nicefrac}




\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.



\usepackage{nicefrac}





\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.



\usepackage{nicefrac}






\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.



\usepackage{nicefrac}







\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.




\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.5 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.




\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
 


\makeatother

\makeatother





\makeatother





\makeatother





\makeatother





\makeatother





\makeatother





\makeatother





\makeatother

\usepackage{babel}

\begin{document}

\title{{\Large Calculation of Thermodynamic Parameters for Dense High-Temperaure Plasma}}

\maketitle

The present paper is essentially the report submitted by a first-year student, 
Pavel Chvykov, after his internship (summer, 2008) (sections 1-4). The 
embedded tables are created by the Fortran code, which is the part of the 
BATSRUS code development for the CRASH project. 

In the installed version of the SWMF code one can use command 'make PDF' from 
the SWMF subdirectory SWMF/util/CRASH/doc to make this dociment. The Fortran 
code will automatically compile the executable IONIZ.exe and run it, which 
will calculate the ionization equilibrium in Xe within wide ranges of 
parameters and put the output data to the tables used in the text 

\section{Introduction and Background}

Understanding the processes that go on in high-density and high-temperature 
plasmas, as well as the response of such plasmas to various external 
disturbances has become increasingly important in the modern world. Such 
plasmas play the key role in many important emerging or possible future 
applications, such as thermonuclear fusion chain reaction, laser particle 
acceleration, and the x-ray laser pumped by nuclear reactions. However, 
experiments with such plasmas are extremely difficult to carry out in a 
controlled lab environment, since the temperatures and densities reached are 
comparable to those of the sun, or of a nuclear explosion, the tests with 
which have been banned around a decade ago. This significantly hinders the 
progress that can be made in understanding such plasmas and in the 
development of the related technologies. 

Hence, computer modeling of the processes that occur in these extremely dense 
and hot plasmas becomes irreplaceable. This is true not only due to the 
complexity of the real world experiments, which are still necessary to 
conduct, but also due to the measurement limitations of such experiments 
-- not all important parameters of such plasmas can be measured 
experimentally, and hence some calculations and modeling are still necessary. 

This work presents a way of calculating the temperature, as well as several 
other fundamental plasma parameters (pressure, degree of ionization, heat 
capacity), assuming that some set of the thermodynamic variables is given.
Usually in Computational Fluid Dynamics (CFD) the pressure should be expressed 
in terms of the internal energy density or via the average internal energy per 
atomic unit in the plasma, the plasma density being the other input parameter 
for the Equation Of State (EOS). This calculation, 
which is very simple for ideal gases, becomes more complex when dealing with 
plasmas. Furthermore, this calculation is described for multi-element, as well 
as for single component plasmas. 

Although this calculation is described for the general case, this work was 
done based on a particular experiment, in which Beryllium foil is accelerated 
via laser radiation along a thin plastic tube ($C_{22} H_{10} N_2$) filled in 
with Xenon. In the process, all these substancess are heated to such 
temperatures that they form a mixture plasma, which then carries shock waves 
formed by the acceleration process, the dynamics of which are then examined.


\section{Ionization Equilibrium}
\subsection{Basics }

To find the thermodynamic characterstics of the plasma one should first 
describe the ionization equilibrium in it.

Population of an ion ($P_{i}$) in a plasma is the probability of
finding that particle in the state possessing a certain charge, i.
Similarly, if we let $N_{a}$ be the heavy particle density -- the
total number of atoms and ions per unit of volume in a plasma -- then,
$N_{i}=P_{i}*N_{a}$, where $N_{i}$ is the concentration of i-level
ions (ions that lost i electrons), and $P_{i}$, their populations.
Furthermore, since the total of probabilities of all the alternative
events is always equal to one, we get
\begin{equation}
\sum_{i=0}^{X}P_{i}=1,
\end{equation}
where X is the atomic number of the element -- hence the maximum charge
it can attain. Or, similarly: 
\begin{equation}
\sum_{i=0}^{X}N_{i}=N_{a},\label{eq:2}
\end{equation}
which is the same equation multiplied by $N_{a}$. Furthermore, since
in a single-component plasma, each of the $N_{i}$ ions looses i electrons,
which is further true for each of the X types of ions, we obtain the
formula for the total number of free electrons per unit volume, $N_{e}$:
\begin{equation}
N_{e}=\sum_{i=0}^{X}iN_{i},\label{eq:3}
\end{equation}
which is the condition of plasma neutrality -- the total positive
charge on the ions per unit of volume in a plasma must be equal to
the total number of free electrons in that volume. If we divide this
equation by $N_{a}$, we get: 
\begin{equation}
Z=<i>=\sum_{i=0}^{X}iP_{i},
\end{equation}
where Z = $N_{e}/N_{a}$ -- the average positive charge per ion in
the plasma (measured in elementary charge units). Here $<i>$ illustrates
that this is the statistical average of the charge per ion. 

From all these formulas we can see that to calculate practically any property
of a plasma, we need to know the populations of all the levels of ions.


\subsection{Boltzmann Distribution}

To calculate the population of an i-level ion at a certain temperature,
we need to know for how many atoms/ions, the energy per atomic cell
is greater than or equal to the energy level of the $i^{th}$ ion.
Thus, we need to know the energy distribution between the atoms and
ions for a given temperature T. 

Here, recall the Maxwell-Boltzmann
distribution, which formulates that the probability of finding a particle
with certain energy in some volume of gas (population of that energy
state) is proportional to the Boltzmann factor: 
\begin{equation}
g_{i}e^{-\frac{E_{i}}{k_{B}T}},
\end{equation}
where the exponent gives the probability of finding a particle in
a specific state with energy $E_{i}$, while $g_{i}$ -- degeneracy
-- is the number of such distinct states that have the same desired
energy. In the case of a plasma, however, the degeneracy value includes
not only the number of states that the i-charged ion might have, but
also the number of distinct states possible for all of the i electrons
that have separated from the original atom. Since each of these electrons
has the same degeneracy value, $g_{e}$, the total number of possible
states for all of these electrons will be $(g_{e})^{i}$. Therefore,
in Eq.(5), $g_{i}$ will be replaced by $g_{i}*(g_{e})^{i}$. Furthermore,
recalling that the sum of the populations of all alternative states
must equal one, we can find the proportionality constant for the Boltzmann
factor. Dividing each of these factors by the value of their sum,
we will normalize them so that their sum after the transformation
will be equal to unity (Eq. 1). Hence, if we also use the ion energy
levels for $E_{i}$ (energy needed to ionize a neutral atom to an
i-charged ion), then the ion populations become: 
\begin{equation}
P_{i}=\frac{g_{i}(g_{e})^{i}e^{-\frac{E_{i}}{k_{B}T}}}{{\displaystyle \sum_{i=0}^{X}g_{i}(g_{e})^{i}e^{-\frac{E_{i}}{k_{B}T}}}},\label{eq:6}
\end{equation}
Here, the sum in the denominator is called the partition function.
The main difficulty with finding the actual populations using this
equation comes from the $g_{e}$ and $g_{i}$ values. Through statistical
and quantum mechanics we can find that the value of $g_{e}$ is: 
\begin{equation}
g_{e}=\frac{2}{N_{e}\Lambda^{3}}\ \ \ \ \ \ \ \ \ \ \ \ \ \Lambda=\sqrt{\frac{h^{2}}{2\pi m_{e}k_{B}T}},
\end{equation}
where $\Lambda$ is the thermal De Broglie wavelength of an electron.

Note that to calculate the value for $g_{e}$, we need to know $N_{e}$,
which is found from Eq.(3) (or 4), which in turn takes the populations
as an input parameter. Hence, we will have to solve a system of coupled 
equations, instead of a single equation, to find the correct population values.
This will be addressed later on in the paper. In regards to the $g_{i}$
values, on the other hand, note that in most cases in a realistic
plasma, while the value of $g_{e}$ might be of the order of $10^{15}$,
the value of $g_{i}$ is usually not grater than 3. Hence, after normalization,
the effect of $g_{i}$ on the final population values will be negligibly
small in comparison. 

Furthermore, since in most cases we are not interested
in the actual population values, but rather in properties of plasma,
such as Z (Eq.4), the slight inaccuracies in the populations will
be evened out by the summation often used to calculate such properties,
making the approximation even less evident. Hence, from now on, we
will ignore the $g_{i}$ values in our equations, approximating them
by $g_{i}\approx1$.


\subsection{Saha Ionization Equation and Calculation Speed Improvement}

Another similar approach to finding the population values (if the
value of $g_{e}$ is known) is using the Saha Ionization Equation.
This equation is obtained by taking the ratio of the populations of
the two consecutive level ions as given by Eq.(6): 
\begin{equation}
\frac{P_{i+1}}{P_{i}}=g_{e}
\frac{g_{i+1}}{g_{i}}e^{-\frac{E_{i+1}-E_{i}}{k_{B}T_{e}}}=
\frac{2}{N_{e}\Lambda^{3}}\frac{g_{i+1}}{g_{i}}e^{-\frac{I_{i+1}}{k_{B}T_{e}}},\label{eq:Saha}
\end{equation}
 or, similarly:
\begin{equation}
\frac{N_{i+1}N_{e}}{N_{i}}=\frac{2}{\Lambda^{3}}\frac{g_{i+1}}{g_{i}}e^{-\frac{I_{i+1}}{k_{B}T_{e}}},
\end{equation}
which is a better known form of the Saha Equation. Note that here
$I_{i+1}=E_{i+1}-E_{i}$ denotes the ionization energy -- energy required
to remove a single electron from an i-charged ion, forming (i+1)-level
ion. These equations can provide an advantage in finding the populations
if the speed of calculation is important. First, realize that if such
is the case, than it is better to avoid the complex exponents of Eq.(6),
which would take a long time to calculate. To do this, we could instead
start with the natural logarithm of Eq.(8) (now ignoring the ratio
$g_{i+1}/g_{i}\approx1$): 
\begin{equation}
\ln P_{i+1}-\ln P_{i}=\ln g_{e}-\frac{I_{i+1}}{k_{B}T_{e}},
\end{equation}
Then, we will let $P_{0}=1$ (ln $P_{0}$ = 0), and using this relationship,
build up and array of non-normalized values of $P_{1}$, $P_{2}$,
$P_{3}$, ..., $P_{X}$. The values of this array will vary greatly,
and some will be very large. To avoid having to find exponents of
huge numbers, we can normalize this array so that the population of
the most probable ion $P_{max}$ = 1 (ln $P_{max}$ = 0). Note that
normalizing an array of logarithms is done by subtraction, rather
than division, since log ($P_{i}$/C) = log $P_{i}$ - log C, and
hence we simply need to subtract ln $P_{max}$ from every term. After
this is done, to simplify the calculations even further, we can get
rid of all the values of the array <-7, for example, because the actual
populations corresponding to these values will be negligibly small
-- $P_{i}<e^{-7}=0.00091$, and can be approximated as zeros. Finally,
at this point, it should not take long to find the exponents of the
remaining part of the array, and normalize them as before so that
their sum equals one. This method can then be used instead of Eq.(6)
any time the population values are needed.

\section{Ionization Equilibrium at a Given Temperature\label{sec:Ionization-Equilibrium}}

In CFD of an ideal gas, the temparature of a fluid is not important. As long
as a conservative numerical scheme is used, the EOS can be applied to express 
the plasma pressure (the momentum flux) in terms of the total energy 
density, a constitutive part of the latter is the internal energy.

On the other hand, the crucial parameter of the ionization equailbrium is the
plasma temperature. That is why while implementing the EOS for the plasma, the
temperature should be first solved from the input parameters and then the 
ion populations should be solved at the given temperature. The latter problem 
is discussed in this section 


\subsection{The System of Equations}

Both of the methods for finding the populations presented above can
only be used if the value of $g_{e}$ is known. However, $g_{e}$
depends on $N_{e}$, which in turn depends on the populations themselves,
and hence we find ourselves faced with solving a system of two equations
-- Eq.(3) (or 4) and Eq.(6) must both be satisfied in order to obtain
the correct population values. 

To solve this system, we first need
to rewrite the term $g_{e}$ as a function of Z: 
\begin{equation}
g_{e}=\frac{2}{N_{e}\Lambda^{3}}=\frac{2}{ZN_{a}\Lambda^{3}}=\frac{C_{1}}{Z},
\end{equation}
$C_{1}$, which is independent of Z, is introduced here only to simplify
this ratio. Hence, the Boltmznn factor from Eq.(5) becomes: 
\begin{equation}
P_{i}\propto\left(\frac{C_{1}}{Z}\right)^{i}e^{-\frac{E_{i}}{k_{B}T_{e}}}=
p_{i}.
\end{equation}
Since this term appears frequently in the further discussion, we
will denote it as $p_{i}$, to simplify the notation. Now, we can combine
equations (4) and (6) into a single equation in Z: 
\begin{equation}
Z=\sum_{i=0}^{X}iP_{i}=\sum_{i=0}^{X}\left(i\frac{p_{i}}{{\displaystyle \sum_{j=0}^{X}}p_{j}}\right)=\frac{{\displaystyle \sum_{i=0}^{X}}ip_{i}}{{\displaystyle \sum_{i=0}^{X}}p_{i}},\label{eq:13}
\end{equation}

\subsection{Iterative Algorithm}
Finally, all the terms in the above equation are known. However, this
expression is too complex to solve by simple algebraic methods and
requires an iterative approach. Direct iterations will converge to
the answer very slowly, if at all. Hence, we will use the Newton-Rapson
iteration method: 
\begin{equation}
x_{n+1}=x_{n}-\frac{f(x_{n})}{f^{\prime}(x_{n})}.
\end{equation}
This method is used to approximate zeros of the function f. If $x_{n}$
is an approximation of the solution (or a trial solution), than $x_{n+1}$
will be a much better approximation. This method does have limitation
as to whether it will converge to the answer, but if $f^{\prime}(x_{n})\geq1$,
then convergence is guaranteed. Further, since this method works only
for finding zeros of the function, considering equation (13), let
\begin{equation}
f(Z)=Z-\frac{\sum i\left(\frac{C_{1}}{Z}\right)^{i}e^{-\frac{E_{i}}{k_{B}T_{e}}}}{\sum\left(\frac{C_{1}}{Z}\right)^{i}e^{-\frac{E_{i}}{k_{B}T_{e}}}},
\end{equation}
then when f(Z)=0, Z will have the desired value. Now, to use the method
as in Eq.(14), we need to know $f^{\prime}(Z)$. 

Let's first find the derivative as follows: 
\begin{eqnarray}
\frac{\partial}{\partial Z}\left[\sum\left(\frac{C_{1}}{Z}\right)^{i}e^{-\frac{E_{i}}{k_{B}T_{e}}}\right]=\sum i\left(\frac{C_{1}}{Z}\right)^{i-1}\ \frac{-C_{1}}{Z^{2}}e^{-\frac{E_{i}}{k_{B}T_{e}}}=\nonumber\\
=-\frac{C_{1}}{Z^{2}}\frac{Z}{C_{1}}\sum i\left(\frac{C_{1}}{Z}\right)^{i}e^{-\frac{E_{i}}{k_{B}T_{e}}}=-\frac{1}{Z}\sum ip_{i},
\end{eqnarray}
and similarly: 
\begin{equation}
\frac{\partial}{\partial Z}\left[\sum ip_{i}\right]=-
\frac{1}{Z}\sum i^{2}p_{i}.
\end{equation}
Now, combining these answers to find $f^{\prime}(Z)$, we get: 
\begin{eqnarray}
\frac{\partial f}{\partial Z}&=&1-\frac{-\frac{1}{Z}\sum i^{2}p_{i}}{\sum p_{i}}-\frac{-\sum ip_{i}}{\left(\sum p_{i}\right)^{2}}\left(-\frac{1}{Z}\sum ip_{i}\right)=\nonumber\\
&=&1+\frac{1}{Z}\left(\frac{\sum i^{2}p_{i}}{\sum p_{i}}-\left(\frac{\sum ip_{i}}{\sum p_{i}}\right)^{2}\right),\label{eq:18}
\end{eqnarray}
Therefore, looking back on Eq.(14) and combining Eq.(15) and (18),
we get the overall resulting equation that can be used to find Z:
\begin{equation}
Z_{n+1}=Z_{n}-\frac{Z_{n}-\frac{\sum ip_{i}}{\sum p_{i}}}{1+\frac{1}{Z}_{n}\left(\frac{\sum i^{2}p_{i}}{\sum p_{i}}-\left(\frac{\sum ip_{i}}{\sum p_{i}}\right)^{2}\right)},
\end{equation}
where the values for $p_{i}$ can be found from equation (12), using
$Z_{n}$ for Z and all sums are across the entire span of possible
ion charges. Further, notice that this equation is equivalent to:
\begin{equation}
Z_{n+1}=Z_{n}-\frac{Z_{n}-<i>_{n}}{1+\frac{1}{Z}_{n}(<i^{2}>_{n}-<i>_{n}\ ^{2})},\label{eq:20}
\end{equation}
where $<i>$ is the approximate average charge per ion, and $<i^{2}>$
is the approximate average of the squares of charges. This equation
can also be used to find Z by first, finding the population values
through either of the presented methods, using $Z_{n}$ for Z in the
calculation of $g_{e}$, and then find the values of $<i>_{n}$ and
$<i^{2}>_{n}$ using the formulas: 
\begin{equation}
<i>=\sum_{i=1}^{X}iP_{i}\ \ \ \ \ \ \ \ <i^{2}>=\sum_{i=1}^{X}i^{2}P_{i},
\end{equation}
Also, from Eq.(20), it can be seen that since the average of the squares
is always greater than the square of the average, $<i^{2}>-<i>^{2}\geq0$,
and hence $f^{\prime}(Z)\geq1$, which then necessarily means that
the iterations will converge. Hence, with these equations, we can
fairly quickly find Z, if our initial guess is reasonably close.
\subsection{Initial Approximation}
In order to make the above iterative approach quick and efficient,
it is important to find a decent first approximation for what the
value of Z is. Since in most cases in plasma, there is a single ion
whose population is much higher than that of all the others, a good
first guess would be that Z is approximately the same as the charge
of that ion. Hence, we need to find the value of i that maximizes
$P_{i}$, or ln $P_{i}$ (which will occur at the same i, but is easier
to find). Recall that at a local extrema of any function, its first
derivative is equal to 0. Since the populations are not defined by
a continuous function, we can similarly say that $\Delta(\ln P_{i})/\Delta i$
is closest to 0 at the maximum value of ln $P_{i}$. Eq.(10) essentially
gives an expression for $\Delta(\ln P_{i})/\Delta i$. Hence, since
we decided to initially approximate $Z\approx i_{P}{}_{max}$, we
can build a sequence of values of what $\Delta(\ln P_{i})/\Delta i$
would be if the current i was equal to $i_{P_{max}}$, and hence to
Z. Hence, we will approximate $g_{e}=C_{1}/Z\approx C_{1}/i$. Further,
when this derivative of the ln $P_{i}$ sequence is $\approx0$, $P_{i}$
will be $\approx P_{i+1}$, and hence i+1 can be used for Z here just
as well. Hence we get: 
\begin{equation}
\frac{\Delta(\ln P_{i})}{\Delta i}=\frac{\ln P_{i}-\ln P_{i-1}}{1}=\ln(\frac{C_{1}}{i})-\frac{I_{i}}{k_{B}T_{e}},
\end{equation}
Then, the value of i for which the right side of this equation is
closest to 0, will be a reasonable initial approximation for Z. Further,
since, as mentioned, i as well as i-1 could be used for Z here, a
better initial approximation would actually be between the two: 
$Z\approx i-0.5$.
A separate case arises when the plasma is weak and the vast majority
of the atoms are not ionized ($Z\approx0$). This implies that the
populations of higher level ions will be negligible compared to those
of $P_{0}$, or even $P_{1}$, and hence, Eq.(13) becomes: 
\begin{equation}
Z=\frac{{\displaystyle \sum_{i=0}^{X}ip_{i}}}{{\displaystyle \sum_{i=0}^{X}p_{i}}}\approx\frac{p_{1}}{p_{0}}=\left(\frac{C_{1}}{Z}\right)e^{-\frac{I_{1}}{k_{B}T_{e}}}.
\end{equation}
This can then be easily solved for Z: 
\begin{equation}
Z\approx\sqrt{C_{1}e^{-\frac{I_{1}}{k_{B}T_{e}}}},
\end{equation}
which is a very good and simple approximation. Hence, when the method
in Eq.(22) yields $i_{P}{}_{max}=1$, the method in Eq.(24) can be
used instead, but only as long as it yields a value for Z less than
1 (if it does not, than $Z\approx1$ and is too large for this method).
\subsection{Section Summary}
Finally, we have concluded that in order to find the ion populations
in a plasma, we can use the following procedure:
\begin{enumerate}
\item Approximate the value of Z (average charge per ion) by first, finding
the value of i for which $$
\ln(\frac{C_{1}}{i})-\frac{I_{i}}{k_{B}T_{e}}$$ 
is closest to 0, and then approximating $Z\approx i-0.5$. Note that
if the i value found is =1, than Z might be very close to zero, in
which case use: $$
Z\approx\sqrt{C_{1}e^{-\frac{I_{1}}{k_{B}T_{e}}}}$$


\begin{itemize}
\item $I_{i}$ is the ionization energy (energy required to remove one electron
from (i-1)-level ion, creating i charged ion) 
\item $k_{B}$ is Boltzmann constant; 
\item $T_{e}$ is the electron temperature; 
\item $C_{1}=2/(N_{a}\Lambda^{3})$

\begin{itemize}
\item $N_{a}$ is the total concentration of atoms and ions in the plasma 
\item $\Lambda=\sqrt{\frac{h^{2}}{2\pi m_{e}k_{B}T}}$, which is the thermal
De Broglie wavelength of an electron.

\begin{itemize}
\item h is Planck's constant 
\item $m_{e}$ is the electron mass 2. 
\end{itemize}
\end{itemize}
\end{itemize}
\item Then, use 
$$
Z_{n+1}=Z_{n}-\frac{Z_{n}-<i>_{n}}{1+\frac{1}{Z}_{n}(<i^{2}>_{n}-<i>_{n}\ ^{2})}$$
to iteratively get a better approximation of Z.

\begin{itemize}
\item To find $<i>_{n}$ and $<i^{2}>_{n}$, first find the population values
using the equation in the next step, and using $Z_{n}$ for Z. Then,
use the formulas:
$$
<i>=\sum_{i=1}^{X}iP_{i}\ \ \ \ \ \ \ \ <i^{2}>=\sum_{i=1}^{X}i^{2}P_{i}$$
\end{itemize}
\item Finally, calculate the populations using: $$
P_{i}=\frac{\left(\frac{C_{1}}{Z}\right)^{i}e^{-\frac{E_{i}}{k_{B}T_{e}}}}{{\displaystyle \sum_{i=0}^{X}\left(\frac{C_{1}}{Z}\right)^{i}e^{-\frac{E_{i}}{k_{B}T_{e}}}}}$$

\item If speed of calculation is important, use the method in section 3
(Eq. 10) instead on the previous step. 
\end{enumerate}
Following is the table that was constructed using the above algorithm.
It shows the $Z$ values calculated for Xenon at various electron temperatures
(given in electron-volts -- the value of $k_{B}T_{e}$, where $k_{B}$
is in eV/K) and heavy particle concentrations (given in number of
particles per $cm^{3}$).
\begin{center}
\input{ionization_table1.tex} 
\par\end{center}
\section{Plasma Thermodynamic Parameters at a Given Temperature}
\subsection{Pressure}
After having set the populations of the ions as above, we can now
calculate some important thermodynamic characteristics of the plasma. 
The most starightforward is a formula for the pressure. In neglecting the 
plasma non-ideality, the pressure is a simple total of the ion contribution,
$N_aT$, and the electron one: $ZN_aT$:
\begin{equation}
P=(1+Z)N_aT.
\end{equation}
With the above procedure for finding $Z$ as a function of $T,\ N_a$ the 
pressure can be easily found. 
 
\subsection{Internal Energy}

Another imprortant characteristic is the average internal energy per 
atomic cell ($U$) -- the energy of the total combination of particles that
originally comprised a whole neutral atom. In fact, experimentally,
this energy, which fundamentally depends on T, is usually much easier
to find than the temperature itself, and hence the value of T actually
has to be calculated from this energy. This calculation will be further
discussed in section \ref{sec:Temperature-Calculation}. First, our
goal is to find U as a function of T for plasma. Recall that for an
ideal gas, the average internal kinetic energy per particle is given
by:
\begin{equation}
U=\frac{3}{2}k_{B}T\label{eq:25}.
\end{equation}
Hence, to find the internal energy of a whole atomic cell in a plasma,
we have to find the sum of the kinetic energies of the ion and all
the electrons that have separated from it, as well as the energy that
was used to separate these electrons ($E_{i}$). Then, averaging this
out across the various charge ions that are present in the plasma,
we get:
\begin{equation}
U=\frac{3}{2}k_{B}T+\sum_{i=1}^{X}P_{i}(\frac{3}{2}ik_{B}T+E_{i})=\frac{3}{2}k_{B}T(1+Z)+<E_{i}>.\label{eq:26}
\end{equation}
Note that this also implies that in plasma, ions have the same average
kinetic energy as electrons do, despite the immense difference in
mass. Furthermore, notice that because of the statistical averages
used in this equation ($Z$ and $<E_{i}>$), which depend on the population
values that in turn depend on the temperature, this equation cannot
be solved for T by simple algebraic methods, and hence finding the
temperature will once again require an iterative approach.
\subsection{Heat Capacity}
Another important thermodynamic parameter of a plasma is its heat
capacity at a constant volume. This parameter is needed to study heat
transmission through the plasma and the variation of temperature and
internal energy of various parts of the plasma with time. This value
will also be needed for the temperature calculation in the next section.
First of all, realize that if volume is constant and $dV=0$, then
the change in internal energy of a system is:
$$
dU=dQ-dW=dQ-PdV=dQ,\ \text{and}$$
\begin{equation}
\frac{dU}{dT}=\frac{dQ}{dT}=C_{V},\label{eq:28}
\end{equation}
where dQ is the heat added to the system, while dW is the work done
by that system.

Hence, our goal now is to find the partial derivative of U, as given
by Eq.\ref{eq:26}, with respect to T. For simplicity, from now on
we will use the value of the temperature measured in electron-volts
-- $T_{eV}=k_{B}T$, where $k_{B}$ is in eV/K. First, begin by taking
the derivative of Eq.\ref{eq:26} only:
\begin{eqnarray}
C_{V}=\frac{\partial U}{\partial T_{eV}}=\frac{3}{2}+\sum\left[P_{i}\left(\frac{3}{2}i\right)+\frac{\partial P_{i}}{\partial T_{eV}}\left(\frac{3}{2}T_{eV}i+E_{i}\right)\right]=\nonumber\\
=\frac{3}{2}(1+Z)+\sum\left[\frac{\partial P_{i}}{\partial T_{eV}}\left(\frac{3}{2}T_{eV}i+E_{i}\right)\right]\label{eq:29}
\end{eqnarray}
Now, we need to find the partial derivative of the populations w.r.t.
temperature. For this we can use the expression from Eq. \ref{eq:6},
written as:
\begin{equation}
P_{i}=\frac{p_{i}}{\sum p_{i}},\ \text{where}\ \ \ \ \ \ \ \ \ \ p_{i}=\left(C_{0}\frac{(T_{eV})^{\nicefrac{3}{2}}}{Z}\right)^{i}e^{-\frac{E_{i}}{T_{eV}}},\label{eq:30}
\end{equation}
where $C_{0}$ is now independent of $T_{eV}$. Thus:
\begin{equation}
\frac{\partial P_{i}}{\partial T_{eV}}=\frac{p_{i}^{\prime}}{\sum p_{i}}-\frac{p_{i}\sum p_{i}^{\prime}}{\left(\sum p_{i}\right)^{2}},\label{eq:31}
\end{equation}
where primes denote the derivatives with respect to $T_{eV}$. Also,
recall that Z is also a function of T, hence for $p_{i}^{\prime}$
we have:
\begin{eqnarray}
p_{i}^{\prime}=\left(C_{0}\frac{(T_{eV})^{\nicefrac{3}{2}}}{Z}\right)^{i}e^{-\frac{E_{i}}{T_{eV}}}\left(\frac{E_{i}}{(T_{eV})^{2}}\right)+\left(C_{0}^{\ \ i}\right)i\left(\frac{(T_{eV})^{\nicefrac{3}{2}}}{Z}\right)^{i-1}\left(\frac{\frac{3}{2}(T_{eV})^{\nicefrac{1}{2}}}{Z}-\frac{(T_{eV})^{\nicefrac{3}{2}}}{Z^{2}} Z^\prime \right)e^{-\frac{E_{i}}{T_{eV}}}=\nonumber\\
=p_{i}\left(\frac{E_{i}}{(T_{eV})^{2}}+i\frac{Z}{(T_{eV})^{\nicefrac{3}{2}}}\left(\frac{\frac{3}{2}(T_{eV})^{\nicefrac{1}{2}}}{Z}-\frac{(T_{eV})^{\nicefrac{3}{2}}}{Z^{2}} Z^\prime \right)\right)=p_{i}\left(\frac{E_{i}}{(T_{eV})^{2}}+i\left(\frac{3}{2T_{eV}}-\frac{ Z^\prime }{Z}\right)\right)\label{eq:32}
\end{eqnarray}
Also, since
\begin{equation}
Z=\frac{\sum ip_{i}}{\sum p_{i}},\ \text{it follows that}\ \ \ \ \ \ \ 
Z^\prime=\frac{\sum ip_{i}^{\prime}}{\sum p_{i}}-\frac{\sum ip_{i}\sum p_{i}^{\prime}}{\left(\sum p_{i}\right)^{2}},\label{eq:33}
\end{equation}
where we can then plug in the expression found for $p_{i}^{\prime}$
in Eq.\ref{eq:32}. Let's first simplify $\sum p_{i}^{\prime}$:
\begin{equation}
\sum p_{i}^{\prime}=\sum\left[\frac{E_{i}p_{i}}{(T_{eV})^{2}}+ip_{i}\left(\frac{3}{2T_{eV}}-\frac{ Z^\prime }{Z}\right)\right]=\frac{\sum E_{i}p_{i}}{(T_{eV})^{2}}+\left(\frac{3}{2T_{eV}}-\frac{ Z^\prime }{Z}\right)\sum ip_{i}\label{eq:34}.
\end{equation}
Further note that for any expression $a$ it is true that its statistical
average is $<a>={\displaystyle \sum_{i=0}^{X}aP_{i}=\frac{\sum ap_{i}}{\sum p_{i}}}$.
Hence, using these formulas in Eq.\ref{eq:33} we get:
\begin{eqnarray}
Z^\prime&=&\frac{1}{(T_{eV})^{2}}\frac{\sum iE_{i}p_{i}}{\sum p_{i}}+\left(\frac{3}{2T_{eV}}-\frac{Z^\prime }{Z}\right)\frac{\sum i^{2}p_{i}}{\sum p_{i}}-\frac{1}{(T_{eV})^{2}}\frac{\sum ip_{i}\sum E_{i}p_{i}}{\left(\sum p_{i}\right)^{2}}-\left(\frac{3}{2T_{eV}}-\frac{Z^\prime }{Z}\right)\frac{\left(\sum ip_{i}\right)^{2}}{\left(\sum p_{i}\right)^{2}}=\nonumber\\
&=&\frac{<iE_{i}>-<i><E_{i}>}{(T_{eV})^{2}}+\left(\frac{3}{2T_{eV}}-\frac{Z^\prime }{Z}\right)\left(<i^{2}>-<i>^{2}\right)\nonumber\\
%Z^\prime\left(\frac{Z + <i^{2}>-<i>^{2}}{Z}\right)&=&\frac{<iE_{i}>-<i><E_{i}>}{(T_{eV})^{2}}+\frac{3}{2T_{eV}}\left(<i^{2}>-<i>^{2}\right)\nonumber\\
\frac{Z^\prime}{Z} &=& \frac{\frac{3}{2}T_{eV}\left(<i^{2}>-<i>^{2}\right)+<iE_{i}>-<i><E_{i}>}{(T_{eV})^{2}\left(Z+<i^{2}>-<i>^{2}\right)}\label{eq:35}
\end{eqnarray}
Finally, we have reached the bottom of this derivation -- everything
in the above equation can be found using the methods presented in
Part I. Now, we can significantly simplify this whole derivative by
working our way up to the beginning. However first, we need to introduce
the following transformation, which is true for any two expressions
$a$ and $b$:
\begin{equation}
<ab>-<a><b>=<\delta a\ \delta b>,\ \text{where}\ \ \ \ \delta a=a-<a>\label{eq:36}\end{equation}
 \[
\text{proof:}\ \ \ <(a-<a>)\ (b-<b>)>=<ab-a<b>-b<a>+<a><b>>=\]
 \[
=<ab>-2<a><b>+<a><b>=<ab>-<a><b>\]
This transformation makes the computation simpler, as well as, in
some cases, gives better accuracy for the value of $<\delta a\ \delta b>$,
which can determine the difference between a zero and a non-zero value.
Also notice that this transformation can be used in the denominator
of Eq. \ref{eq:20}. Further, applying this transformation and combining
Eq.\ref{eq:35} and Eq.\ref{eq:32} we get:
\begin{eqnarray}
p_{i}^{\prime}=p_{i}\left(\frac{E_{i}}{(T_{eV})^{2}}+i\ \frac{\frac{3}{2}T_{eV}\left(Z+<(\delta i)^{2}>\right)-\frac{3}{2}T_{eV}<(\delta i)^{2}>-<\delta i\ \delta E_{i}>}{(T_{eV})^{2}\left(Z+<(\delta i)^{2}>\right)}\right)=\nonumber\\
=\frac{p_{i}}{(T_{eV})^{2}}\left(E_{i}+i\ \frac{\frac{3}{2}T_{eV}Z-<\delta i\ \delta E_{i}>}{Z+<(\delta i)^{2}>}\right),\ \text{and let this}=\alpha p_{i}\label{eq:37}
\end{eqnarray}
Here $\alpha$ is introduced only to simplify the notation for the
next step, which then transforms Eq.\ref{eq:31} as:
\begin{eqnarray}
\frac{\partial P_{i}}{\partial T_{eV}}=\frac{\alpha p_{i}}{\sum p_{i}}-\frac{p_{i}\sum\alpha p_{i}}{\left(\sum p_{i}\right)^{2}}=P_{i}(\alpha-<\alpha>)=P_{i}(\delta\alpha)=\nonumber\\
=\frac{P_{i}}{(T_{eV})^{2}}\left(\delta E_{i}+\delta i\left(\frac{\frac{3}{2}T_{eV}Z-<\delta i\ \delta E_{i}>}{Z+<(\delta i)^{2}>}\right)\right),\ \text{and let this}=\frac{P_{i}}{(T_{eV})^{2}}\left(\delta E_{i}+\beta\delta i\right).\label{eq:38}
\end{eqnarray}
Here, again, we introduce $\beta$ only for simplicity of notation.
At this point, we can finally come back to our original Eq.\ref{eq:29}.
First, however, note that the transformation given in Eq.\ref{eq:36}
can also be written as:
\begin{equation}
<\delta a\ b>=<ab-<a>b>=<ab>-<a><b>=<\delta a\ \delta b>,\label{eq:39}
\end{equation}
Using this and Eq.\ref{eq:38} we can now transform Eq.\ref{eq:29}
as follows:
\begin{eqnarray}
C_{V}&=&\frac{\partial U}{\partial T_{eV}}=\frac{3}{2}(1+Z)+\sum\left[\frac{P_{i}}{(T_{eV})^{2}}\left(\delta E_{i}+\beta\delta i\right)\left(\frac{3}{2}T_{eV}i+E_{i}\right)\right]=\nonumber\\
&=&\frac{3}{2}(1+Z)+\frac{1}{(T_{eV})^{2}}<\left(\delta E_{i}+\beta\delta i\right)\left(\frac{3}{2}T_{eV}\delta i+\delta E_{i}\right)>=\nonumber\\
&=&\frac{3}{2}(1+Z)+\frac{1}{(T_{eV})^{2}}<(\delta E_{i})^{2}+\left(\frac{3}{2}T_{eV}+\beta\right)\delta i\ \delta E_{i}+\frac{3}{2}T_{eV}\beta(\delta i)^{2}>=
\nonumber\\
&=&\frac{3}{2}(1+Z)+\frac{1}{(T_{eV})^{2}}\Biggl(<(\delta E_{i})^{2}>+\left(\frac{\frac{3}{2}T_{eV}\left(Z+<(\delta i)^{2}>\right)+\frac{3}{2}T_{eV}Z-<\delta i\ \delta E_{i}>}{Z+<(\delta i)^{2}>}\right)<\delta i\ \delta E_{i}>+
\nonumber\\
&+&\frac{3}{2}T_{eV}\frac{\frac{3}{2}T_{eV}Z-<\delta i\ \delta E_{i}>}{Z+<(\delta i)^{2}>}<(\delta i)^{2}>\Biggr)=
\nonumber\\
&=&\frac{3}{2}(1+Z)+\frac{1}{(T_{eV})^{2}}\left(<(\delta E_{i})^{2}>+\frac{3T_{eV}Z<\delta i\ \delta E_{i}>-<\delta i\ \delta E_{i}>^{2}+\frac{9}{4}(T_{eV})^{2}Z<(\delta i)^{2}>}{Z+<(\delta i)^{2}>}\right)=\nonumber\\
&=&\frac{3}{2}(1+Z)+<\left(\frac{\delta E_{i}}{T_{eV}}\right)^{2}>+\frac{3Z\left(\frac{3}{4}<(\delta i)^{2}>+<\delta i\ \frac{\delta E_{i}}{T_{eV}}>\right)-<\delta i\ \frac{\delta E_{i}}{T_{eV}}>^{2}}{Z+<(\delta i)^{2}>}=C_{V}.\label{eq:Cv}
\end{eqnarray}
This equation can then be used to find the heat capacity at constant
volume when the temperature is known. Following is a table built using
this equation, as well as Eq. \ref{eq:26}, that shows the values
of average internal energy {[}eV] and heat capacity per atomic cell,
calculated at various values of $T_{eV}$ and $N_{a}$. %Once again,
%the unrealistic negative values mark the domain where our assumption
%that $g_{e}\gg1$ fails, and hence a different method is required
%for finding the correct plasma parameters.
\begin{center}
\input{ionization_table2.tex} 
\par\end{center}
\section{Temperature Calculation from a Given Internal Energy\label{sec:Temperature-Calculation}}
For all of the above calculations, it was assumed that the temperature
of the plasma was a given input parameter for the problem. However,
in realistic experiments, it is usually not possible, or not easy,
to measure the temperature directly. It is, however, possible to measure
the total internal energy of a volume of plasma, which can then, using
a known heavy particle density value, be converted to the average
internal energy per atomic cell ($U$). This energy can then be used
to find the value of the temperature, however, as can be seen from
Eq. \ref{eq:26}, this cannot be done algebraically and hence, we
will once again use the Newton-Rapson iterations method. As before,
since this approach can only be used to iteratively find the zeros
of a function, this function needs to be 
\begin{equation}
f(T)=\frac{3}{2}k_{B}T(1+Z)+<E_{i}>-U,\label{eq:27}.
\end{equation}
where U is a given constant. Then when $f(T)=0$, we will have the
desired value for T. Furthermore, to use this method, we also need
to have an expression for $f^{\prime}(T)$, which now becomes simply
$\partial U/\partial T=C_{V}$. Hence, we have everything needed to
prroceed with the Newton's method:
\begin{equation}
T_{n+1}=T_{n}-\frac{U(T_{n})-U_{given}}{C_{V}(T_{n})},\ \text{where}\ \ U=\frac{3}{2}k_{B}T(1+Z)+<E_{i}>\text{and}\label{eq:CalcT}
\end{equation}
\[
C_{V}=\frac{3}{2}(1+Z)+<\left(\frac{\delta E_{i}}{T_{eV}}\right)^{2}>+\frac{3Z\left(\frac{3}{4}<(\delta i)^{2}>+<\delta i\ \frac{\delta E_{i}}{T_{eV}}>\right)-<\delta i\ \frac{\delta E_{i}}{T_{eV}}>^{2}}{Z+<(\delta i)^{2}>},
\]
while for any expression $a$, $<a>={\displaystyle \sum_{i=0}^{X}aP_{i}}$
and $\delta a=a-<a>$, where the populations are found using the trial
value of T and the method presented in section \ref{sec:Ionization-Equilibrium}.

However, unlike with iterations on Z, here convergence is not guaranteed
when starting at any value of T. Although in most cases the iterations
will eventually converge, they will do so slowly and before approaching
the correct value, they might make huge jumps from one side of the
correct T to another, which can lead to T becoming negative at one
of the iterations. Since to calculate the populations and Z, which
is necessary to do for every iteration, we need to at some point find
the value of $\sqrt{T}^{3}$, when T becomes negative, this has no
real answer and will make further iterations impossible. To make matters
worse, because the relationship between U and T is so complex, there
is no nice way to initially approximate the value of T so as to speed
up the iterations and avoid huge jumps.

Therefore, the only way left to avoid this problem is to hard-code
some limits on the iteration jumps, such as not letting the iterations
jump lower than half or higher than twice the trial value of T. This
way, the Newton-Rapson equation will initially only point out the
general direction of the correct value of T relative to the trial
value, while the iterations will only half or double the trial value
until it gets close enough to the actual T. Following is a table of
the temperature values {[}eV] calculated at the given internal energies
{[}eV] and heavy particle densities {[}$1/cm^{3}$]. The number of
iterations it took to find each temperature value is also given.% and
%the negative values are used as before.
\begin{center}
\input{ionization_table3.tex} 
\par\end{center}

The use of non-conservative scheme may also require to find the
internal energy density as a function of the given pressure:
\begin{center}
\input{ionization_table4.tex} 
\par\end{center}
\section{Plasma Parameters for Mixtures}
\subsection{The Basics}
In many cases in practice, the plasma does not consist of just a single
element, as was assumed for all of the above calculations, but rather
of a mixture of several different elements. If such is the case, then
all the main formulas that the above methods were based on now take
on a slightly different form. Hence, the entire procedure for finding
the ionization equilibrium and then thermodynamic plasma parameters
will have to be reevaluated for this case. On the other hand, the
changes will not be too drastic as the basic principles of plasma
formation are still in effect.

First, let's introduce the element concentration factors $C_{j}$
that give the part of the entire mixture, by number of heavy particles,
that the element with index $j$ comprises:
\begin{equation}
C_{j}=\frac{N_{j}}{N_{a}}=\frac{{\displaystyle \sum_{i=0}^{X}N_{ij}}}{N_{a}}\text{, and hence also }\sum_{j=1}^{n}C_{j}=1\label{eq:Cj}.
\end{equation}
Here, the index i, as before, refers the i-charged ion. Furthermore,
these concentration factors will be taken here as a given input parameter
to the problem.

With regards to the populations, note that a population of a certain
ion, by definition, still remains as the part that the ion comprises
out of all the ions of only that same element, and not out of the
entire $N_{a}$. Hence, we get the following formulas for the populations:
\begin{equation}
P_{ij}=\frac{N_{ij}}{N_{j}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \sum_{i=0}^{X}P_{ij}=1\label{eq:Pij}.
\end{equation}
Combining Eq. \ref{eq:Cj} and \ref{eq:Pij} we can then obtain the
expression for the part that a certain charge ion of a certain element
comprises out of the entire mixture:

\begin{equation}
\frac{N_{ij}}{N_{a}}=C_{j}P_{ij}\label{eq:40}
\end{equation}
Further, we can also obtain a formula for the total number of free
electrons per unit of volume of plasma, which will be just the sum
of the electrons coming from each element, which in turn is still
calculated as in Eq. \ref{eq:3}: 
\begin{equation}
N_{e}=\sum_{j=1}^{n}\left[\sum_{i=1}^{X}iN_{ij}\right]\label{eq:NeMix}
\end{equation}
Then dividing both sides by $N_{a}$, we obtain the average charge
per ion:

\begin{equation}
Z=<i_{j}>=\sum_{j=1}^{n}\left[C_{j}\sum_{i=1}^{X}iP_{ij}\right]=\sum_{j=1}^{n}\left(C_{j}<i>_{j}\right)\label{eq:Zmix}
\end{equation}
Notice that here, $<i_{j}>$ denotes the average along two dimensions,
instead of just one as was done before and as in $<i>_{j}$. Hence,
we can see that basically the only thing that is different about calculating
the properties of a mixture plasma is that each calculation has to
be performed separately for each of the elements in the mixture, and
then the statistical average of the obtained values has to be taken
across all of the elements present.
\subsection{Ionization Equilibrium}
When finding the population values for a mixture plasma, we see, from
Eq. \ref{eq:6}, or the Saha Equation (Eq. \ref{eq:Saha}), that the
various elements in the mixture do not interact with each other in
any way other than through the free electrons, or similarly, through
the value of Z. Hence, the only difference in the calculation will
be in the expression that we use for Z. Hence, transforming Eq. \ref{eq:13}
to fit the form in Eq. \ref{eq:Zmix}, we get:
\begin{equation}
Z=\sum_{j=1}^{n}\left[C_{j}\frac{{\displaystyle \sum}ip_{ij}}{{\displaystyle \sum}p_{ij}}\right]\text{, where as before }p_{ij}=\left(\frac{C_{1}}{Z}\right)^{i}e^{-\frac{E_{ij}}{k_{B}T_{e}}}\label{eq:41}
\end{equation}
Since Z has to be found iteratively anyway, we do not need to worry
about the additional complexity introduced by the double summation
here. Furthermore, since $C_{j}$ values are given constants, they
will not affect the value of the derivative of this expression with
respect to Z, which is also needed to use the Newton's method. Hence,
this derivative of the above expression becomes, using Eq. \ref{eq:18}:
\begin{equation}
-\frac{1}{Z}\sum_{j=1}^{n}C_{j}\left(<i^{2}>_{j}-<i>_{j}^{\ 2}\right)=-
\frac{1}{Z}\sum_{j=1}^{n}C_{j}<(\delta i)^{2}>_{j}.\label{eq:42}
\end{equation}
Hence, the equation that defines the Newton's iterative method here
becomes:
\begin{equation}
Z_{n+1}=Z_{n}-\frac{Z_{n}-\sum_{j}\left[C_{j}<i>_{j}\right]}{1+\frac{1}{Z_{n}}\sum_{j}\left[C_{j}<(\delta i)^{2}>_{j}\right]}.\label{eq:IterMix}
\end{equation}
Here, once again, for any expression $a,\ <a>_{j}={\displaystyle \sum_{i=0}^{X}aP_{ij}\text{, and }\delta a=a-<a>}$.
This equation can then be used to find the population values and Z
for a mixture plasma, while finding the populations exactly as for
a single component plasma.
\subsection{Thermodynamic Parameters}
As with most other characteristics of a mixture plasma, to find the
average internal energy per atomic cell, we need to use Eq. \ref{eq:26}
to find this energy for each individual element, and then find the
statistical average of these values across all elements. Also, note that from here on, for any expression $a, \ll a\gg =\sum_{j}[C_{j}\sum_{i}(P_{ij}a_{ij})]$, which is the statistical average first, across the populations and then, across the elements. 
\begin{equation}
U=\sum_{j}C_{j}\left(\frac{3}{2}k_{B}T(1+<i>_{j})+<E_{i}>_{j}\right)=\frac{3}{2}k_{B}T(1+Z)+\ll E_{ij}\gg .\label{eq:Umix}
\end{equation}
Hence, the equation remains essentially the same, except here all
averages are taken along 2 dimensions -- first across the populations
and then across the elements.

Now, to find the derivative $\partial U/\partial T$, which is again the heat
capacity at constant volume, we will use the sum given for U in Eq. \ref{eq:Umix}. Here, the summation across the elements remains outside of the expression unaffected by the differentiation. Further, the derivative of the inside expression is found in the same way as for single component plasma, except for the stage of finding $Z^\prime$, since Z is now given by Eq. \ref{eq:41}. Hence, using Eq. \ref{eq:35}, we can obtain the expression for $Z^\prime$:
\begin{eqnarray}
&&Z^{\prime}=\sum_{j}C_{j}\left[\frac{<\delta i\ \delta E_{i}>} {(T_{eV})^{2}} + \left(\frac{3}{2T_{eV}}-\frac{Z^{\prime}}{Z}\right)\left(<(\delta i)^{2}>\right)\right]\nonumber\\
&&Z^{\prime}+\frac{Z^{\prime}}{Z}\ll(\delta i)^{2}\gg = \frac{\frac{3}{2}T_{eV}\ll(\delta i)^{2}\gg+\ll\delta i\ \delta E_{i}\gg} {(T_{eV})^{2}}\nonumber\\
&&\frac{Z^{\prime}}{Z} = \frac{\frac{3}{2}T_{eV}\ll(\delta i)^{2}\gg+\ll\delta i\ \delta E_{i}\gg}{(T_{eV})^{2}\left(Z+\ll(\delta i)^{2}\gg\right)}.\label{eq:43}
\end{eqnarray}
This expression is the same as the one obtained for single component plasma, except now all the averages are separately taken along both dimensions. Now, if we follow this expression through the subsequent steps of the derivation of the heat capacity expression for a single component plasma, presented earlier, then we notice that it translates into the expression for $\beta$ introduced later on in the derivation. Hence, since the above expression is independent of the element ($j$), $\beta$ also becomes independent of $j$. Therefore, using the derivation for $C_V$ from Eq. \ref{eq:Cv} and recalling the outside summation from Eq. \ref{eq:Umix}, we obtain:
\begin{eqnarray}
C_V &=& \sum_{j}C_{j} \left[ \frac{3}{2}(1+<i>_{j}) + \frac{1}{(T_{eV})^{2}} \left(<(\delta E_{i})^{2}>_{j} + \left(\frac{3}{2}T_{eV}+\beta\right) <\delta i\ \delta E_{i}>_{j} + \frac{3}{2}T_{eV}\beta <(\delta i)^{2}>\right) \right]= \nonumber\\
&=&\frac{3}{2}(1+Z)+\frac{1}{(T_{eV})^{2}}\Biggl(\ll(\delta E_{i})^{2}\gg+\left(\frac{3}{2}T_{eV}+\beta\right)\ll\delta i\ \delta E_{i}\gg+\frac{3}{2}T_{eV}\beta\ll(\delta i)^{2}\gg\Biggr).
\end{eqnarray}
This equation is again exactly the same as the one obtained in the derivation for single component plasma, except that all the averages are now separately taken across the elements as well. Therefore, we can conclude that the final expression for the heat capacity here will also be the same as for single element plasma except for the averaging domain. Hence, for a mixture plasma, the heat capacity is given by:
\begin{equation}
C_V = \frac{3}{2}(1+Z) + \ll\left(\frac{\delta E_{i}}{T_{eV}}\right)^{2}\gg + \frac{3Z\left(\frac{3}{4}\ll(\delta i)^{2}\gg+\ll\delta i\ \frac{\delta E_{i}}{T_{eV}}\gg\right)-\ll\delta i\ \frac{\delta E_{i}}{T_{eV}}\gg^{2}}{Z+\ll(\delta i)^{2}\gg},\label{eq:CvMix}
\end{equation}
where for any expressions $a$ and $b, \ll \delta a\ \delta b \gg = \sum_j \left[ C_j \sum_i \left(P_{ij} (a_{ij}-<a_i>_j)(b_{ij}-<b_i>_j)\right) \right]$.

Finally, same way as before, we can use these two equations for $U$
and $C_{V}$ to iteratively find the temperature from a given average
internal energy using the Newton-Rapson iterations (first part of
Eq. \ref{eq:CalcT}). 

The results of the thermodynamic calculations for polyimide $C_{22}H_{10}N_2O_5$ is provided in the following table:
\begin{center}
\input{ionization_table5.tex} 
\par\end{center}


\section {Conclusion}

In this work, a method was presented for calculating such parameters of the plasma as 
its temperature ($T$), pressure ($P$), average ionization state ($Z$), and populations 
of various level ions ($P_i$) from a given average internal energy per atomic unit in 
that plasma. This method was also somewhat optimized for faster performance in a 
computer program, since such calculation may need to be performed millions of times 
within a cell-based plasma modeling program, which this calculation was meant for. 

This file is closed in June, 2009, because the approach of the Boltzmann electron gas
does not meet the practical requirements. The CRASH code moved towards an account of the 
Fermi statistics for electrons, the Coulomb interactions as well as the detailed analysis
of the excited level populations. The further progress is described in HEDP.pdf document.

\end{document}
